-- =============================================================================
-- BARROW'S INEQUALITY - MINIMAL FORMULATION
-- =============================================================================
-- Key inequality (after AM-GM): a + b + c >= (b+c)*cx + (c+a)*cy + (a+b)*cz
--
-- Rewriting: a*(1 - cy - cz) + b*(1 - cz - cx) + c*(1 - cx - cy) >= 0
--
-- With half-angles α + β + γ = π, using cos(α) = cx, etc.:
-- We need: cx + cy + cz <= 3/2 (well-known for angles summing to π)
-- And: 1 - cy - cz >= cx - 1, etc.
--
-- Actually, the cleanest formulation uses the half-angle constraint differently.
-- =============================================================================

:set-timeout 300
:optimize on

-- Use normalized distances: a + b + c = 1
:assume (> a 0)
:assume (> b 0)
:assume (> c 0)
:assume (= (+ a (+ b c)) 1)

-- Cosine variables for half-angles
:assume (> cx 0)
:assume (> cy 0)
:assume (> cz 0)
:assume (< cx 1)
:assume (< cy 1)
:assume (< cz 1)

-- The key constraint: for half-angles summing to π, cos sum is bounded
-- cos(α) + cos(β) + cos(γ) <= 3/2 when α + β + γ = π
:assume (<= (+ cx (+ cy cz)) (/ 3 2))

-- Goal: 1 >= (b+c)*cx + (c+a)*cy + (a+b)*cz
-- Since a+b+c=1: b+c = 1-a, c+a = 1-b, a+b = 1-c
-- So: 1 >= (1-a)*cx + (1-b)*cy + (1-c)*cz
--     1 >= cx + cy + cz - (a*cx + b*cy + c*cz)
--     a*cx + b*cy + c*cz >= cx + cy + cz - 1

-- With cx+cy+cz <= 3/2, we need: a*cx + b*cy + c*cz >= (cx+cy+cz) - 1
-- Since a+b+c=1 and all positive, this is about weighted averages

:auto (>= 1 (+ (* (- 1 a) cx) (+ (* (- 1 b) cy) (* (- 1 c) cz))))

