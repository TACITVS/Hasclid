-- ============================================================================
-- HASCLID v9.1 - CAD CRITICAL TESTS (Fixed - No <= or <)
-- ============================================================================
-- Focus: The most important CAD tests, especially Section 6 (timeout tests)
-- ============================================================================

:verbose

-- ============================================================================
-- SECTION 1: CORE CAD FUNCTIONALITY (Multivariate Inequalities)
-- ============================================================================

-- Test 1.1: Trivial Sum of Squares
:reset
(>= (+ (^ x 2) (^ y 2)) 0)

-- Test 1.2: Sum of Squares (3 variables)  
:reset
(>= (+ (^ x 2) (+ (^ y 2) (^ z 2))) 0)

-- Test 1.3: Weighted Sum of Squares
:reset
(>= (+ (* 2 (^ x 2)) (* 3 (^ y 2))) 0)

-- Test 1.4: Non-trivial Positive Polynomial
:reset
(>= (+ (^ x 2) (+ (* x y) (^ y 2))) 0)

-- ============================================================================
-- SECTION 2: GEOMETRIC INEQUALITIES
-- ============================================================================

-- Test 2.1: Triangle Inequality
:reset
:point A 0 0
:point B 3 4
:point C 6 0
(>= (+ (dist2 A B) (dist2 B C)) (dist2 A C))

-- Test 2.2: Distance Always Non-negative
:reset
:point P x1 y1
:point Q x2 y2
(>= (dist2 P Q) 0)

-- ============================================================================
-- SECTION 6: THE CRITICAL TIMEOUT TESTS (Most Important!)
-- ============================================================================

-- Test 6.1: Square_3_Lines Concrete (S=1) - Should be INSTANT
:reset
:set-timeout 5
:point A 0 0
:point B 1 0
:point C 1 1
:point D x y
:assume (= (dist2 C D) 1)
:assume (= (perpendicular B C C D) 0)
(= (dist2 D A) 1)

-- Test 6.2: Square_3_Lines Symbolic (THE KEY TEST!)
-- THIS WAS TIMING OUT IN v9.0
-- Expected: Should complete with Week 1 optimizations
:reset
:set-timeout 15
:point A 0 0
:point B S 0
:point C S S
:point D x y
:assume (= (dist2 C D) (^ S 2))
:assume (= (perpendicular B C C D) 0)
(= (dist2 D A) (^ S 2))

-- Test 6.3: Square_3_Lines Symbolic (Extended timeout)
:reset
:set-timeout 30
:point A 0 0
:point B S 0
:point C S S
:point D x y
:assume (= (dist2 C D) (^ S 2))
:assume (= (perpendicular B C C D) 0)
(= (dist2 D A) (^ S 2))

-- ============================================================================
-- SECTION 7: PERFORMANCE SCALING
-- ============================================================================

-- Test 7.1: 2D Inequality
:reset
(>= (+ (^ x 2) (^ y 2)) (+ x y))

-- Test 7.2: 3D Inequality
:reset
(>= (+ (^ x 2) (+ (^ y 2) (^ z 2))) (+ x (+ y z)))

-- Test 7.3: 4D Inequality
:reset
:set-timeout 30
(>= (+ (^ a 2) (+ (^ b 2) (+ (^ c 2) (^ d 2)))) 0)

-- ============================================================================
-- SECTION 8: CUMULATIVE OPTIMIZATIONS
-- ============================================================================

-- Test 8.1: Complex Positivity
:reset
(>= (+ (^ x 4) (+ (* 2 (^ x 2) (^ y 2)) (^ y 4))) 0)

-- Test 8.2: Quartic with 4 variables
:reset
(>= (+ (^ a 4) (+ (^ b 4) (+ (^ c 2) d))) 0)

-- Test 8.3: Mixed Terms
:reset
(>= (+ (^ x 2) (+ (* x y) (+ (^ y 2) 1))) 0)

-- ============================================================================
-- END OF CRITICAL TESTS
-- ============================================================================
