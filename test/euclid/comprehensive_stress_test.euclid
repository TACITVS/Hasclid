-- =============================================================================
-- HASCLID COMPREHENSIVE STRESS TEST SUITE (v9.1)
-- =============================================================================
-- This script systematically tests every capability of the Hasclid prover,
-- ranging from Level 0 (Trivial) to Level 9 (System Stress/Fallback).
--
-- Usage: :load examples/comprehensive_stress_test.euclid
-- =============================================================================

:verbose
:set-timeout 5

-- =============================================================================
-- LEVEL 0: TRIVIAL BASICS
-- Testing: Parser, Constants, Identity
-- =============================================================================
(= 1 1)
(= 0 0)
(= (+ 1 1) 2)

-- =============================================================================
-- LEVEL 1: GEOMETRIC PRIMITIVES (NUMERIC)
-- Testing: Point definition, Distance, Perpendicularity checks
-- =============================================================================
:reset
:point Origin 0 0
:point P34 3 4
:point P30 3 0

-- Distance check (3-4-5 triangle)
(= (dist2 Origin P34) 25)

-- Perpendicularity check (Axes are perpendicular)
:point XAxis 10 0
:point YAxis 0 10
(= (perpendicular Origin XAxis Origin YAxis) 0)

-- =============================================================================
-- LEVEL 2: ALGEBRAIC IDENTITIES
-- Testing: Polynomial arithmetic, expansion, simplification
-- =============================================================================
:reset
-- Binomial expansion
(= (^ (+ x y) 2) (+ (+ (^ x 2) (* 2 (* x y))) (^ y 2)))

-- Difference of squares
(= (* (- x y) (+ x y)) (- (^ x 2) (^ y 2)))

-- =============================================================================
-- LEVEL 3: LOGICAL REASONING
-- Testing: Assumptions, Implication, Boolean Logic
-- =============================================================================
:reset
:assume (= a b)
:assume (= b c)
-- Transitivity
(= a c)

:reset
:assume (> x 0)
:assume (> y 0)
-- Strict inequality inference (CAD/Logic)
(> (+ x y) 0)

-- =============================================================================
-- LEVEL 4: CLASSIC GEOMETRY (CONCRETE)
-- Testing: Geometric theorem proving with fixed coordinates
-- =============================================================================
:reset
-- Theorem: Diagonals of a square bisect each other (Concrete Square)
:point A 0 0
:point B 2 0
:point C 2 2
:point D 0 2
:point MidAC 1 1
:point MidBD 1 1

-- Verify M is midpoint of AC
(= (dist2 A MidAC) (dist2 C MidAC))
(= (+ (dist2 A MidAC) (dist2 MidAC C)) (dist2 A C))

-- =============================================================================
-- LEVEL 5: SYMBOLIC GEOMETRY (BASIC)
-- Testing: Variable coordinates, simple theorems
-- =============================================================================
:reset
-- Theorem: Isosceles Triangle Theorem (Base angles equal)
-- Setup: Triangle ABC with AB = AC
:point A 0 h
:point B (- w) 0
:point C w 0

-- Check side lengths
(= (dist2 A B) (+ (^ w 2) (^ h 2)))
(= (dist2 A C) (+ (^ w 2) (^ h 2)))

-- Prove equality of sides implies equality of distance to midline axis (symmetry)
(= (dist2 B A) (dist2 C A))

-- =============================================================================
-- LEVEL 6: INEQUALITIES & CAD
-- Testing: Cylindrical Algebraic Decomposition, Positivity
-- =============================================================================
:reset
-- Sum of squares is non-negative
(>= (+ (^ x 2) (^ y 2)) 0)

-- Circle interior
:assume (< (+ (^ x 2) (^ y 2)) 1)
-- If x^2 + y^2 < 1, then x < 1 (Logic check)
(< x 1)

-- =============================================================================
-- LEVEL 7: COMPLEX GEOMETRY (SYMBOLIC - WU'S METHOD)
-- Testing: Router selection, Wu's Method, Characteristic Sets
-- =============================================================================
:reset
-- Apollonius Theorem (Symbolic)
-- b^2 + c^2 = 2(m^2 + d^2)
:point A 0 0
:point B (* 2 d) 0
:point C c1 c2
-- M is midpoint of AB
:point M d 0

-- Verify formula: AB^2 + AC^2 = 2(AM^2 + MC^2) ?? 
-- Actually Apollonius is CA^2 + CB^2 = 2(CM^2 + AM^2)
-- Let's verify simpler midpoint property
(= (dist2 A M) (dist2 M B))

-- =============================================================================
-- LEVEL 8: QUANTIFIERS
-- Testing: Forall/Exists logic, CAD lifting
-- =============================================================================
:reset
-- For every real x, x^2 + 1 > 0
(forall x (> (+ (^ x 2) 1) 0))

-- There exists an x such that x^2 - 1 = 0
(exists x (= (- (^ x 2) 1) 0))

-- =============================================================================
-- LEVEL 9: THE "IMPOSSIBLE" STRESS TEST (TIMEOUT & FALLBACK)
-- Testing: Complexity explosion handling, Timeout mechanism, Symbolic Fallback
-- =============================================================================
:reset
-- Set short timeout to force the fallback logic
:set-timeout 2

-- Problem: "Square 3 Lines" with Symbolic Parameter S
-- This typically hangs algebraic solvers due to degree explosion
:point A 0 0
:point B S 0
:point C S S
:point D x y

:assume (= (dist2 C D) (* S S))
:assume (= (perpendicular B C C D) 0)

-- This check should:
-- 1. Try symbolic proof (and likely timeout after 2s)
-- 2. Catch the timeout
-- 3. Retry with S=1
-- 4. Return result for S=1
(= (dist2 D A) (* S S))

-- =============================================================================
-- TEST COMPLETE
-- =============================================================================
