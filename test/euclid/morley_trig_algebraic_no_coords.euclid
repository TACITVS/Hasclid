; ======================================================================
; Morley's Theorem - Algebraic/Trigonometric Proof (no coordinates)
; ----------------------------------------------------------------------
; Encodes the classical trig proof entirely as polynomial constraints.
; Angles: A=3α, B=3β, C=3γ with α+β+γ=π/3.
; Variables: sA,cA,sB,cB,sG,cG = sin/cos of α,β,γ; r3 = sqrt(3); R = circumradius.
; Side lengths of Morley triangle are asserted equal via the known formula:
;   8 R sinα sinβ sinγ  (and symmetric cyclic variants).
; All equations are cleared of denominators to remain polynomial.
; ======================================================================

:verbose
:set-timeout 60

; Unit-circle constraints for third-angles
:assume (= 1 (+ (^ cA 2) (^ sA 2)))
:assume (= 1 (+ (^ cB 2) (^ sB 2)))
:assume (= 1 (+ (^ cG 2) (^ sG 2)))

; Symbolic sqrt(3)
:assume (= (^ r3 2) 3)
:assume (> r3 0)

; Angle sum α+β+γ = π/3 encoded via sin/cos of (π/3−γ):
; cos(α+β) = cos(π/3−γ) = (1/2)cG + (√3/2)sG
; sin(α+β) = sin(π/3−γ) = (√3/2)cG − (1/2)sG
; Clear denominators by multiplying by 2.
:assume (= 0 (+ (* 2 (- (* cA cB) (* sA sB))) (* -1 cG) (* -1 r3 sG)))
:assume (= 0 (+ (* 2 (+ (* sA cB) (* cA sB))) (* -1 r3 cG) sG))

; Triple-angle identities rewritten with r3 (sin(π/3±x) expansions):
; sin(3x) = 4 sin x sin(π/3+x) sin(π/3−x)
; where sin(π/3+x) = (√3/2)c + (1/2)s, sin(π/3−x) = (√3/2)c − (1/2)s.
; For each of α, β, γ, we introduce sin3A, sin3B, sin3G.
:assume (= sin3A (+ (* 3 sA) (* -4 (^ sA 3))))          ; classical cubic form
:assume (= sin3B (+ (* 3 sB) (* -4 (^ sB 3))))
:assume (= sin3G (+ (* 3 sG) (* -4 (^ sG 3))))

; Sides of original triangle (not used explicitly except for scaling)
:assume (= a (* 2 R sin3A))
:assume (= b (* 2 R sin3B))
:assume (= c (* 2 R sin3G))

; Morley side formulas (scaled) with denominators cleared by factor 2:
; side_ABp = 8 R sA sG sin(π/3+α)
; sin(π/3+α) = (r3/2)*cA + (1/2)*sA
; Multiply by 2 to clear halves: side_ABp2 = 16 R sA sG ((r3/2)cA + (1/2)sA) = 8R sA sG (r3 cA + sA)
:assume (= sideAB2 (* 8 R sA sG (+ (* r3 cA) sA)))

; side_BCp = 8 R sA sG sin(π/3+γ) = 8R sA sG ((r3/2)cG + (1/2)sG) -> cleared:
:assume (= sideBC2 (* 8 R sA sG (+ (* r3 cG) sG)))

; side_ACp = 8 R sA sB sG (already polynomial, no √3 factor)
:assume (= sideAC2 (* 8 R sA sB sG))

; Equilateral: sideAB2 = sideBC2 = sideAC2
:prove (= sideAB2 sideBC2)
:prove (= sideBC2 sideAC2)
