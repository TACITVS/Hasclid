-- =============================================================================
-- BARROW'S INEQUALITY - CORE LEMMA (Reduced Variables)
-- =============================================================================
-- The key inequality after AM-GM reduction:
--   a + b + c >= (b+c)*cx + (c+a)*cy + (a+b)*cz
--
-- Where:
--   - a, b, c > 0 (distances PA, PB, PC)
--   - cx, cy, cz are cosines of half-angles (0 < cos < 1)
--   - The half-angles satisfy α + β + γ = π
--
-- Using tangent substitution: x = tan(α), y = tan(β), z = tan(γ)
--   - x + y + z = xyz (tangent identity)
--   - cx² = 1/(1 + x²), cy² = 1/(1 + y²), cz² = 1/(1 + z²)
-- =============================================================================

:set-timeout 180
:optimize on
:verbose
-- Tangent variables (positive for angles in (0, π/2))
:assume (> x 0)
:assume (> y 0)
:assume (> z 0)

-- Tangent identity for α + β + γ = π
:assume (= (+ x (+ y z)) (* x (* y z)))

-- Distance variables (positive)
:assume (> a 0)
:assume (> b 0)
:assume (> c 0)

-- WLOG: scale so a + b + c = 1 (normalization)
:assume (= (+ a (+ b c)) 1)

-- The goal is to prove:
-- 1 >= (b+c)*cx + (c+a)*cy + (a+b)*cz
--
-- Since cx = 1/sqrt(1+x²), we have cx² = 1/(1+x²)
-- This means: (1+x²)*cx² = 1
--
-- With normalization a+b+c=1:
--   b+c = 1-a, c+a = 1-b, a+b = 1-c
--
-- Goal becomes:
-- 1 >= (1-a)*cx + (1-b)*cy + (1-c)*cz

-- For symmetric case x=y=z (equilateral at center):
-- x = sqrt(3) (since tan(60°) = sqrt(3))
-- cx = cos(60°) = 1/2
-- RHS = (1-a)*0.5 + (1-b)*0.5 + (1-c)*0.5
--     = 0.5*(3 - (a+b+c)) = 0.5*(3-1) = 1
-- So equality holds at symmetric point!

-- Try the simplest case: symmetric x=y=z
-- Then x+x+x = x*x*x => 3x = x³ => x² = 3 => x = sqrt(3)

:assume (= x y)
:assume (= y z)

-- Now x+y+z = 3x = x³ => x² = 3
:assume (= (^ x 2) 3)

-- Cosine: cx² = 1/(1+3) = 1/4, so cx = 1/2
:assume (= (^ cx 2) (/ 1 4))
:assume (> cx 0)
:assume (= cy cx)
:assume (= cz cx)

-- Goal: 1 >= (1-a)*cx + (1-b)*cy + (1-c)*cz
-- With symmetric cosines: 1 >= cx*[(1-a) + (1-b) + (1-c)]
-- = cx * [3 - (a+b+c)] = cx * [3 - 1] = 2*cx = 2*(1/2) = 1

:auto (>= 1 (+ (* (- 1 a) cx) (+ (* (- 1 b) cy) (* (- 1 c) cz))))


